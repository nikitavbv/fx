kv:
- id: code
  driver: sqlite
  params:
    in_memory: true
  keys:
  - key: dashboard
    file: "./target/wasm32-unknown-unknown/release/fx_cloud_dashboard.wasm"
  - key: dashboard-events-consumer
    file: "./target/wasm32-unknown-unknown/release/fx_cloud_dashboard.wasm"
  - key: hello-service
    file: "./target/wasm32-unknown-unknown/release/fx_app_hello_world.wasm"
  - key: rpc-test-service
    file: "./target/wasm32-unknown-unknown/release/fx_app_rpc_test_service.wasm"
  - key: "counter"
    file: "./target/wasm32-unknown-unknown/release/fx_app_counter.wasm"
- id: compiler
  driver: sqlite
  params:
    in_memory: true
- id: cron-state
  driver: sqlite
  params:
    in_memory: true
- id: demo-db
  driver: sqlite
  params:
    in_memory: true

sql:
- id: dashboard

functions:
- id: dashboard
  sql:
  - binding: dashboard
    id: dashboard
  triggers:
  - http: 8080
    rpc: "http"
- id: dashboard-events-consumer
  system: true
  sql:
  - binding: dashboard
    id: dashboard
  triggers:
  - queue: "system/invocations"
    rpc: "on_invoke"
- id: hello-service
  kv:
  - binding: demo
    id: demo
  sql:
  - binding: test-db
    id: demo-d
  triggers:
  - cron: "*/10 * * * * * *"
    rpc: "on_cron"
  permissions:
  - "fetch"
- id: rpc-test-service
- id: counter
  global: true
